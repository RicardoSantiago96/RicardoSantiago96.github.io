<!DOCTYPE html>
<html>
  <head>
    <title>GitHub 02</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/estilos.css">
    
    <script src="https://www.gstatic.com/firebasejs/8.6.3/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.3/firebase-app.auth.js"></script>
    <script src="js/fb.js"></script>
  </head>
  <body>
      <h1>Autenfificación</h1>
      <h1>Sesión</h1>
      <fieldset>
          <legend>Email</legend>
          <output id="email"><progress max="100">Cargando</progress></output>
      </fieldset>
      <figure><img id="avatar" alt="Avatar"></figure>
      <button type="button" onclick="TerminarSesion()">Terminar Sesion</button>
      <footer>Copyright 2021 3CV50 Programación Web, Santiago Robles Ricardo Alberto</footer>
      <script>
          const auth = firebase.auth();
          const provider = firebase.auth.GoogleAuthProvider();
          auth.onAuthStateChanged(
            usuarioAuth=>{
                if (usuarioAuth && usuarioAuth.email){
                    email.value = usuarioAuth.email;
                    nombre.value = usuarioAuth.displayName;
                    avatar.src = usuarioAuth.protoURL;
                }else{
                    auth.signInWithRedirect(provider);
                }
            },
            procesaError
        );
async function TerminarSesion(){
    try{
        await auth.sigtOut();
    }catch (e){
        procesarError(e);
    }
}
function procesarError(e){
    console.log(e);
    aler(e.mesaage);
}
       </script>
  </body>
</html>
